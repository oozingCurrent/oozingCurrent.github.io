<!DOCTYPE html>
<html>
<head><meta charset="utf-8"><title>project placeholder</title></head>
<body>
    
<h1 id="placeholder">canvas selection</h1><br>
<p id="status1">status 1: </p>
<p id="status2">status 2: </p>
<p id="status3">status 3: </p>
<br>

<canvas id="canvasMain" width="256" height="256" style="border:3px solid #ff0000;">
Your browser does not support the HTML5 canvas tag.</canvas><br>

<canvas id="canvasSelection" width="" height="64" style="border:3px solid #0000ff;">
Your browser does not support the HTML5 canvas tag.</canvas>

<script>
    var image;
    var selectionImageSize = 64;
    var imageForCanvas = new Image();
    var images = ["/pictures/body.png", "/pictures/eyes.png", "/pictures/mouth.png"];
    
//    function toArray(list) {
//        return Array.prototype.slice.call(list || [], 0);
//    }
//
//    function listResults(entries) {
//        // Document fragments can improve performance since they're only appended
//        // to the DOM once. Only one browser reflow occurs.
//        var fragment = document.createDocumentFragment();
//        
//        entries.forEach(function(entry, i) {
//        var img = entry.isDirectory ? '<img src="folder-icon.gif">' :
//                                      '<img src="file-icon.gif">';
//        var li = document.createElement('li');
//        li.innerHTML = [img, '<span>', entry.name, '</span>'].join('');
//        fragment.appendChild(li);
//        });
//        document.querySelector('#filelist').appendChild(fragment);
//    }
//    
//    function onInitFs(fs) {
//        var dirReader = fs.root.createReader();
//        var entries = [];
//        // Call the reader.readEntries() until no more results are returned.
//        var readEntries = function() {
//            dirReader.readEntries (function(results) {
//                if (!results.length) {
//                    listResults(entries.sort());
//                } else {
//                    entries = entries.concat(toArray(results));
//                    readEntries();
//                }
//            }, errorHandler);
//        };
//
//        readEntries(); // Start reading dirs.
//    }
//    
//    window.requestFileSystem(window.TEMPORARY, 1024*1024, onInitFs, errorHandler);
    
    function refreshCanvasMain() {
        var canvas = document.getElementById("canvasMain");
        var ctx = canvas.getContext("2d");
        imageForCanvas.src = images[0];
        ctx.drawImage(imageForCanvas, 0,0);
        imageForCanvas.src = images[1];
        ctx.drawImage(imageForCanvas, 0,0);
        imageForCanvas.src = images[2];
        ctx.drawImage(imageForCanvas, 0,0);
        
        image = canvas.toDataURL("image/png");
    };
    
    function refreshCanvasSelection() {
        var canvas = document.getElementById("canvasSelection");
        var ctx = canvas.getContext("2d");
        var imageSize = selectionImageSize;
        
        document.getElementById("status1").innerHTML ="status 1: ";
        
        for (i = 0; i < images.length; i++) {
             document.getElementById("status1").innerHTML += i + ": ok (" +images.length+ ")... ";
             imageForCanvas.src = images[i];
             ctx.drawImage(imageForCanvas, i*64 ,0, imageSize, imageSize);
        }
        
//        imageForCanvas.src = images[0];
//        ctx.drawImage(imageForCanvas, 0,0, imageSize, imageSize);
//        imageForCanvas.src = images[Math.floor((Math.random() * 3))];
//        ctx.drawImage(imageForCanvas, 64,0, imageSize, imageSize);
//        imageForCanvas.src = images[Math.floor((Math.random() * 3))];
//        ctx.drawImage(imageForCanvas, 128,0, imageSize, imageSize);
    };
    
    function download() {
        document.write('<img src="'+image+'"/>');
    };
    
    document.getElementById("status2").innerHTML += images.length + 1;
    document.getElementById("canvasSelection").width = selectionImageSize * (images.length);
    
//     window.onload = refreshCanvasMain();
//     window.onload = refreshCanvasSelection();
   
</script>    

<br>
<button class="button-refresh-canvas-main" id="button_refresh_canvas_main" onclick="refreshCanvasMain()">Refresh Main</button>
<button class="button-download" id="button_download" onclick="download()">Download</button>
<button class="button-refresh-canvas-selection" id="button_refresh_canvas_selection" onclick="refreshCanvasSelection()">Render Selection</button>

</body>
</html>
